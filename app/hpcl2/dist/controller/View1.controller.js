sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("hpcl2.controller.View1",{onInit:function(){var e=new sap.ui.model.json.JSONModel({isVisible:false});this.getView().setModel(e,"productsModel")},onPress:function(e){var t=this.getView().byId("fileUploader");var o=t.oFilePath.oParent.oFileUpload.files[0];var a=this.getView().getModel();var r=this.getView().getModel().getServiceUrl();if(o==undefined){sap.m.MessageBox.warning("Please upload the file")}else{if(o){var i=new FileReader;i.onload=e=>{var t=e.target.result;var o=this.getView().getModel("productsModel");var i=new Uint8Array(t);var n="";i.forEach(function(e){n+=String.fromCharCode(e)});var s=btoa(n);var l={Excelbase64:s};$.ajax({type:"POST",contentType:"application/json",url:r+"excelExtract",data:JSON.stringify(l),success:function(e,t,r){a.aBindings=e.value;sap.m.MessageBox.success(`Processed successfully, download the excel file.`,{onClose:function(e){if(e==="OK"){o.setProperty("/isVisible",true)}}})},error:function(){}});console.log("Base64 String:",s)};i.readAsArrayBuffer(o);this.sValue=t.mProperties.value}}},onDownload:function(){var e=this.getView().getModel().aBindings;var t=window.atob(e);var o=t.length;var a=new Uint8Array(o);for(let e=0;e<o;e++){a[e]=t.charCodeAt(e)}var r=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var i=document.createElement("a");var n=URL.createObjectURL(r);i.href=n;i.download=this.sValue;document.body.appendChild(i);i.click();document.body.removeChild(i);URL.revokeObjectURL(n)}})});
//# sourceMappingURL=View1.controller.js.map