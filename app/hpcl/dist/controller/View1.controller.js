sap.ui.define(["sap/ui/core/mvc/Controller","hpcl/libs/xlsx.full.min"],function(e){"use strict";return e.extend("hpcl.controller.View1",{onInit:function(){},onPress:function(e){var t=[];var a=this.getView().byId("fileUploader");var r=a.oFilePath.oParent.oFileUpload.files[0];var o=this.getView().getModel();var n=this.getView().getModel().getServiceUrl();if(r){var i=new FileReader;i.onload=function(e){var t=new Uint8Array(e.target.result);var a=XLSX.read(t,{type:"array"});var r=XLSX.utils.sheet_to_json(a.Sheets[a.SheetNames[0]]);r.shift();var i={ExcelData:r};$.ajax({type:"POST",contentType:"application/json",url:n+"calculatedata",data:JSON.stringify(i),success:function(e,t,a){o.aBindings=e.value.ExcelData;sap.m.MessageBox.success("File has been successfully uploaded")},error:function(){}});var s="";var l=new Uint8Array(e.target.result);var c=l.byteLength;for(var d=0;d<c;d++){s+=String.fromCharCode(l[d])}return window.btoa(s)};i.readAsArrayBuffer(r);this.sValue=a.mProperties.value}},onDownload:function(){var e=this.getView().getModel().aBindings;var t=XLSX.utils.json_to_sheet(e);var a=XLSX.utils.book_new();XLSX.utils.book_append_sheet(a,t,"Partial Match");var r=XLSX.write(a,{bookType:"xlsx",type:"array"});var o=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=document.createElement("a");var i=URL.createObjectURL(o);n.href=i;n.download=this.sValue;document.body.appendChild(n);n.click();document.body.removeChild(n);URL.revokeObjectURL(i)}})});
//# sourceMappingURL=View1.controller.js.map